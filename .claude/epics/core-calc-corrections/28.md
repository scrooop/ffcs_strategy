---
name: Refactor ATM Strike Selection (50Δ Anchor)
status: completed
created: 2025-10-20T04:35:49Z
updated: 2025-10-20T05:35:00Z
github: https://github.com/scrooop/ffcs_strategy/issues/28
depends_on: [23, 25]
parallel: false
conflicts_with: [31]
---

# Task 003: Refactor ATM Strike Selection (50Δ Anchor)

## Description

Modify `pick_atm_strike()` to use delta-based selection targeting 50Δ call strike instead of strike nearest to spot. Add fallback to nearest-spot if no strikes within ±0.10Δ tolerance.

## Acceptance Criteria

- [ ] Update `pick_atm_strike()` function signature to accept `greeks_map` parameter
- [ ] Primary logic: Find strike with call delta closest to 0.50
- [ ] Fallback logic: If no strikes within ±0.10Δ, use existing nearest-to-spot logic
- [ ] Return tuple includes actual delta: (strike, delta, call_symbol, put_symbol)
- [ ] Add unit tests for delta selection (within tolerance, fallback cases)
- [ ] Update call sites to pass greeks_map and handle delta return value
- [ ] Log when fallback to nearest-spot is used (for monitoring)

## Technical Details

- **File:** scripts/ff_tastytrade_scanner.py
- **Function location:** ~line 242
- **Greeks map:** Already available from snapshot_greeks() call
- **Delta tolerance:** 0.10 (configurable constant)

## Dependencies

- Task 001 (validation functions)
- Task 002 (skip tracking if no strikes found)

## Effort Estimate

- **Size:** M
- **Hours:** 4-5
- **Parallel:** false (conflicts with Task 004)

## Definition of Done

- [ ] Function refactored with delta-based selection
- [ ] Fallback logic tested
- [ ] Unit tests passing
- [ ] All call sites updated
- [ ] Logging added for fallback cases
