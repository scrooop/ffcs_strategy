---
name: Enhanced Greeks Collection
status: open
created: 2025-10-19T08:51:48Z
updated: 2025-10-19T08:51:48Z
github: [Will be updated when synced to GitHub]
depends_on: []
parallel: true
conflicts_with: [004]
---

# Task: Enhanced Greeks Collection

## Description
Modify existing `snapshot_greeks()` function to collect both IV (implied volatility) and delta values from dxFeed Greeks streaming. This enables delta-based strike selection for double calendar structures while maintaining backward compatibility.

## Acceptance Criteria
- [ ] `snapshot_greeks()` returns dict mapping streamer_symbol â†’ `(iv: float, delta: float)` tuples
- [ ] Function signature updated: `async def snapshot_greeks(...) -> Dict[str, Tuple[float, float]]`
- [ ] Greeks.delta extracted alongside Greeks.volatility
- [ ] Existing ATM scanning logic continues to work (backward compatible)
- [ ] Timeout handling preserves partial results
- [ ] None/null values handled gracefully

## Technical Details

**Implementation Approach:**
- Modify `snapshot_greeks()` to collect both `Greeks.volatility` and `Greeks.delta`
- Update return type from `Dict[str, float]` to `Dict[str, Tuple[float, float]]`
- Update all call sites to unpack tuples: `iv, delta = greeks_data[symbol]`
- Maintain existing timeout-based snapshot collection logic

**Files Affected:**
- `scripts/ff_tastytrade_scanner.py` - Modify `snapshot_greeks()` function
- Main scanning loop - Update unpacking of Greeks results

**Key Considerations:**
- Backward compatibility: Existing ATM code should require minimal changes
- Delta may be None for some strikes (handle gracefully)
- Both call and put Greeks needed (average IV if both available, use single if only one)

## Dependencies
- [ ] dxFeed Greeks streaming provides delta field
- [ ] tastytrade SDK DXLinkStreamer functional

## Effort Estimate
- Size: S
- Hours: 1-2 hours
- Parallel: true (can develop alongside Task 001)

## Definition of Done
- [ ] Code implemented with type hints
- [ ] Function docstring updated with new return type
- [ ] Existing ATM scanning continues to work
- [ ] Manual testing: Greeks data includes valid delta values
- [ ] No crashes when delta is None/missing
