---
name: CLI Enhancement & Help Documentation
status: completed
created: 2025-10-19T08:51:48Z
updated: 2025-10-19T18:30:00Z
completed: 2025-10-19T18:30:00Z
github: https://github.com/scrooop/ffcs_strategy/issues/8
depends_on: [001, 003, 004, 005]
parallel: false
conflicts_with: []
---

# Task: CLI Enhancement & Help Documentation

## Description
Consolidate all new CLI flags into argument parser, add comprehensive help documentation, implement flag validation, and ensure backward compatibility with v1.0 commands.

## Acceptance Criteria
- [x] All flags added to argparse with sensible defaults
- [x] `--help` output documents all flags with examples
- [x] Flag validation implemented (e.g., --min-liquidity-rating 0-5)
- [x] Conflicting flags detected (e.g., --skip-earnings + --allow-earnings)
- [x] v1.0 commands work unchanged (backward compatible)
- [x] Help text includes usage examples from PRD Appendix C

## Technical Details

**New CLI Flags to Add:**
```bash
# Earnings Filtering (Task 001)
--skip-earnings              # Skip positions with earnings conflicts (default: True)
--allow-earnings             # Allow trading through earnings
--show-earnings-conflicts    # Show filtered positions due to earnings

# Liquidity Screening (Task 001)
--min-liquidity-rating N     # Minimum liquidity rating 0-5 (default: 3)
--skip-liquidity-check       # Disable liquidity filtering

# X-earn IV Support (Task 005)
--use-xearn-iv               # Use X-earn IV from market metrics (default: True)
--force-greeks-iv            # Always use dxFeed Greeks IV

# Double Calendar Structure (Tasks 003, 004)
--structure {atm-call,double,both}  # Calendar structure type (default: both)
--delta-tolerance N                  # Max deviation from ±35Δ (default: 0.05)
```

**Validation Rules:**
- `--min-liquidity-rating`: 0 ≤ N ≤ 5
- `--delta-tolerance`: 0.01 ≤ N ≤ 0.10
- `--skip-earnings` and `--allow-earnings`: mutually exclusive
- `--use-xearn-iv` and `--force-greeks-iv`: mutually exclusive
- `--structure`: must be one of {atm-call, double, both}

**Help Text Example:**
```
usage: ff_tastytrade_scanner.py [options]

Example usage:
  # Daily pre-market scan (production)
  python ff_tastytrade_scanner.py --tickers SPY QQQ AAPL --pairs 30-60 --min-ff 0.23 --csv-out scan.csv

  # Focus on double calendars
  python ff_tastytrade_scanner.py --tickers SPY QQQ --pairs 60-90 --structure double --min-ff 0.20
```

**Files Affected:**
- `scripts/ff_tastytrade_scanner.py` - Modify argument parser, add validation

**Key Considerations:**
- Default behavior matches safest production use (skip earnings, use liquidity filter)
- Help text should enable new users to run scanner without reading docs
- Flag descriptions should be concise but complete

## Dependencies
- [ ] Task 001 completed (earnings/liquidity flags)
- [ ] Task 003 completed (delta-tolerance flag)
- [ ] Task 004 completed (structure flag)
- [ ] Task 005 completed (X-earn IV flags)

## Effort Estimate
- Size: S
- Hours: 1-2 hours
- Parallel: false (requires multiple dependencies)

## Definition of Done
- [ ] Code implemented with validation
- [ ] `--help` output comprehensive and accurate
- [ ] Manual testing: All flags work as expected
- [ ] Validation catches invalid inputs (e.g., --min-liquidity-rating 10)
- [ ] v1.0 commands tested and work unchanged
- [ ] Help text includes real usage examples
