---
name: Futures Options Support
status: completed
created: 2025-10-19T18:55:13Z
updated: 2025-10-19T19:15:00Z
completed: 2025-10-19T19:15:00Z
github: [Will be updated when synced to GitHub]
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Futures Options Support

## Description

Investigate and validate whether the current FF scanner can handle futures options contracts. Test with common futures symbols like /ES (E-mini S&P 500 futures) and /GC (Gold futures) to determine if the scanner works out-of-box or requires modifications.

## Acceptance Criteria

- [x] Test scanner with futures options symbols (/ES, /GC, /NQ, /CL)
- [x] Document which tastytrade API endpoints support futures options
- [x] Identify any code changes needed for futures support
- [x] Document differences between equity options and futures options (Greeks, IV, expiration handling)
- [x] Provide clear recommendation: works as-is, needs minor tweaks, or requires major refactor

## Technical Details

**Futures Symbols to Test:**
- `/ES` - E-mini S&P 500 futures
- `/GC` - Gold futures
- `/NQ` - E-mini Nasdaq-100 futures
- `/CL` - Crude Oil futures

**Key Investigation Areas:**
1. **Symbol format:** Does tastytrade API accept `/ES` vs `ES` format?
2. **Option chain structure:** Do futures options use same `NestedOptionChain` API?
3. **Greeks availability:** Does dxFeed provide Greeks for futures options?
4. **Expiration cycles:** Futures options have different expiration patterns (weekly, monthly, quarterly)
5. **Strike conventions:** Futures options may use different strike increments
6. **IV calculation:** Does forward IV calculation work the same for futures?

**Scanner Components to Validate:**
- `get_market_data()` - Can it fetch futures underlying price?
- `NestedOptionChain.get()` - Works with futures symbols?
- `snapshot_greeks()` - Greeks available for futures options?
- `forward_iv()` - Calculation valid for futures?
- `fetch_market_metrics()` - Earnings (N/A for futures), liquidity ratings?

**Expected Challenges:**
- Futures don't have earnings (earnings filter should be disabled)
- Different expiration naming (e.g., `/ESH25` for March 2025)
- Potential differences in how tastytrade handles futures vs equity options

## Test Plan

1. **Quick Smoke Test:**
   ```bash
   python scripts/ff_tastytrade_scanner.py \
     --tickers /ES /GC \
     --pairs 30-60 \
     --min-ff 0.20 \
     --skip-earnings \
     --csv-out futures_test.csv
   ```

2. **API Exploration:**
   - Check tastytrade SDK docs for futures support
   - Test `Session`, `NestedOptionChain`, `DXLinkStreamer` with futures
   - Verify Greeks data structure matches equity options

3. **Comparison Test:**
   - Run scanner on SPY (equity) and /ES (futures) side-by-side
   - Compare CSV output, Greeks values, IV calculations
   - Document any discrepancies

## Dependencies

- [x] Access to tastytrade production account with futures permissions
- [x] Futures options trading approval (may differ from equity options)

## Effort Estimate

- Size: M
- Hours: 3-4 hours
- Parallel: true (independent investigation, can run alongside other tasks)

## Definition of Done

- [x] Tested scanner with at least 2 futures symbols (/ES, /GC)
- [x] Documented test results (success/failure, error messages)
- [x] Identified required code changes (if any)
- [x] Created follow-up task if major changes needed
- [x] Updated CLAUDE.md or README with futures support status
- [x] Recommendation provided: supported, partial support, or not supported

## Investigation Results

**Completed:** 2025-10-19
**Status:** âœ… **PARTIAL SUPPORT - RECOMMENDED FOR IMPLEMENTATION**

**Key Findings:**
- tastytrade API fully supports futures options
- `NestedOptionChain.get()` works with `/ES`, `/GC` (confirmed via tests)
- Scanner requires 4 code modifications (symbol detection, spot price, earnings filter, CLI bug fix)
- Estimated effort: 3-5 hours for full implementation
- No fundamental blockers - changes are isolated and low-risk

**Detailed Findings:**
See `/Users/wnv/cc/personal_finance/ffcs_strategy/.claude/epics/ff-scanner-v2/updates/12/findings.md`

**Next Steps:**
1. Create implementation task (Task #13) to add futures support
2. Priority: Fix `--allow-earnings` CLI bug first (affects both equity and futures)
3. Test with /ES, /GC, /NQ after implementation
