---
name: Add Terminal Output Modes (--quiet, --verbose)
status: open
created: 2025-10-20T17:48:36Z
updated: 2025-10-20T18:23:15Z
github: https://github.com/scrooop/ffcs_strategy/issues/39
depends_on: [38]
parallel: false
conflicts_with: [38, 40]
---

# Task: Add Terminal Output Modes (--quiet, --verbose)

## Description

Add `--quiet` and `--verbose` CLI flags to control terminal output verbosity. Quiet mode shows only summary and errors. Verbose mode shows ALL symbols (including filtered/skipped). Integrate with Task #38's logging system.

**Priority:** MEDIUM (Phase 4 - Terminal Output & Logging)

**Depends On:** Task #38 must be complete (logging system established)

## Acceptance Criteria

- [ ] `--quiet` flag added to argparse
- [ ] `--verbose` flag added to argparse
- [ ] Quiet mode suppresses per-symbol output (ERROR level only)
- [ ] Verbose mode shows ALL symbols (pass, filter, skip, error)
- [ ] Normal mode (default) shows only passed symbols and warnings/errors
- [ ] Final summary shown in all modes
- [ ] Existing `--debug` flag updated to use DEBUG log level

## Technical Details

### Files to Modify
- `scripts/ff_tastytrade_scanner.py`:
  - Add argparse flags (around line 1750-1800)
  - Update `setup_logging()` to use mode parameter (modified in Task #38)
  - Update main() to determine mode from flags

### Implementation Approach

**1. Add CLI Flags:**
```python
parser.add_argument(
    '--quiet',
    action='store_true',
    help='Quiet mode: suppress per-symbol output, show only summary and errors'
)
parser.add_argument(
    '--verbose',
    action='store_true',
    help='Verbose mode: show ALL symbols (pass, filter, skip, error)'
)
```

**2. Determine Mode in main():**
```python
# In main() after argparse (Task #38 added setup_logging call here)
if args.debug:
    mode = "debug"
elif args.quiet:
    mode = "quiet"
elif args.verbose:
    mode = "verbose"
else:
    mode = "normal"

logger = setup_logging(mode)
```

**3. Update scan() to Show All Symbols in Verbose Mode:**
```python
# In scan() function, add logging for ALL symbols
for sym in tickers:
    # ... fetch data ...

    # Existing: Log passed opportunities
    if ff >= min_ff:
        logger.info(f"{sym}: PASS (FF={ff:.2f}, strike={strike})")

    # NEW: In verbose mode, log filtered/skipped symbols too
    elif mode == "verbose":
        if earnings_conflict:
            logger.info(f"{sym}: FILTER earnings_conflict ({earnings_date})")
        elif volume_too_low:
            logger.info(f"{sym}: FILTER volume_too_low ({volume}k < {threshold}k)")
        elif delta_not_found:
            logger.info(f"{sym}: SKIP delta_not_found")
        # ... etc for all skip reasons
```

**4. Preserve Summary Output:**
```python
# Final summary (shown in ALL modes, including quiet)
logger.info(f"Scan complete: {scanned} scanned, {passed} passed, {filtered} filtered ({elapsed:.1f}s)")
```

### Key Considerations
- Quiet mode still shows ERROR level (critical failures)
- Verbose mode uses INFO level for all symbols
- Normal mode (default) uses INFO level but only logs passed symbols
- Pass `mode` parameter to scan() function to enable verbose symbol logging
- Summary always shown (even in quiet mode)

### Output Examples

**Quiet Mode (--quiet):**
```
Scan complete: 150 scanned, 23 passed, 127 filtered (82s)
```

**Normal Mode (default):**
```
[SPY   ] PASS: FF=0.285 (30-60 DTE, strike=450.0, double)
[TSLA  ] PASS: FF=0.235 (60-90 DTE, strike=880.0, atm-call)
Scan complete: 150 scanned, 23 passed, 127 filtered (82s)
```

**Verbose Mode (--verbose):**
```
[SPY   ] PASS: FF=0.285 (30-60 DTE, strike=450.0, double)
[QQQ   ] FILTER: earnings_conflict (2025-11-15)
[AAPL  ] FILTER: volume_too_low (3.2k < 10k)
[TSLA  ] PASS: FF=0.235 (60-90 DTE, strike=880.0, atm-call)
[META  ] ERROR: no_market_data (API timeout)
... (ALL 150 symbols shown)
Scan complete: 150 scanned, 23 passed, 127 filtered (82s)
```

## Dependencies

**Internal:**
- [x] Task #38 (Hierarchical Logging System) must be complete
- [ ] Conflicts with Task #38 (same code sections for setup_logging)
- [ ] Conflicts with Task #40 (same code sections for logger handlers)

## Effort Estimate

- **Size:** S (Small)
- **Hours:** 3-4 hours
- **Parallel:** false (conflicts with tasks 38, 40)

### Breakdown:
- Add flags & update mode selection: 1 hour
- Update scan() to log all symbols in verbose mode: 1-2 hours
- Testing all three modes: 1 hour

## Definition of Done

- [ ] `--quiet` flag implemented and tested
- [ ] `--verbose` flag implemented and tested
- [ ] Quiet mode suppresses per-symbol output
- [ ] Verbose mode shows all 150 symbols in test scan
- [ ] Normal mode shows only passed symbols (default behavior)
- [ ] Summary always shown in all modes
- [ ] No conflicts with flags (e.g., --quiet + --verbose = error or picks one)
