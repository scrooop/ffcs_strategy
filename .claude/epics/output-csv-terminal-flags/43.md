---
name: Update Documentation (CLAUDE.md, README_TT.md)
status: open
created: 2025-10-20T17:48:36Z
updated: 2025-10-20T18:23:15Z
github: https://github.com/scrooop/ffcs_strategy/issues/43
depends_on: [36, 38, 39, 40, 41, 42]
parallel: true
conflicts_with: []
---

# Task: Update Documentation (CLAUDE.md, README_TT.md)

## Description

Update project documentation to reflect v3.0 CSV schema, new CLI flags (`--iv-ex-earn`, `--quiet`, `--verbose`, `--log-file`), and terminal output modes. Add column mapping table for v2.2 → v3.0 migration.

**Priority:** LOW (Phase 5 - Documentation & Testing)

**Depends On:** Tasks 36, 38, 39, 40, 41, 42 must be complete (features implemented)

## Acceptance Criteria

- [ ] CLAUDE.md updated with v3.0 CSV schema (32 columns)
- [ ] CLAUDE.md includes column mapping table (v2.2 → v3.0)
- [ ] CLAUDE.md documents new CLI flags with usage examples
- [ ] README_TT.md updated with terminal output mode examples
- [ ] README_TT.md includes `--iv-ex-earn` performance comparison
- [ ] Version history section updated (v2.2 → v3.0)

## Technical Details

### Files to Modify
- `CLAUDE.md`:
  - Update CSV Output Schema section (currently 40-column v2.2 schema)
  - Add Migration Guide subsection (v2.2 → v3.0 column mapping)
  - Update CLI flags section
  - Update version history
- `scripts/README_TT.md`:
  - Update usage examples with new flags
  - Add terminal output mode examples
  - Add performance comparison (`--iv-ex-earn` vs default)

### Implementation Approach

**1. Update CLAUDE.md CSV Schema Section:**
```markdown
### CSV Output Schema (40 Columns - v2.2)  <!-- REMOVE -->
### CSV Output Schema (32 Columns - v3.0)  <!-- ADD -->

**Column Order (Trading-Focused Layout):**

| # | Column | Type | ATM | Double | Description |
|---|--------|------|-----|--------|-------------|
| 1 | timestamp | ISO 8601 | ✓ | ✓ | Scan time (UTC) |
| 2 | symbol | string | ✓ | ✓ | Ticker symbol |
| ... (32 columns total) ...

**Changes from v2.2:**
- Removed: `atm_strike`, `atm_delta`, `atm_ff`, `atm_iv_front`, `atm_iv_back`, `atm_fwd_iv`, `atm_iv_source_front`, `atm_iv_source_back` (8 columns)
- Renamed: `call_strike` → `strike`, `call_delta` → `delta`, `call_ff` → `ff`
- Total: 40 → 32 columns (20% reduction)
```

**2. Add Migration Guide Section:**
```markdown
### Migration Guide v2.2 → v3.0

**For CSV Parsers (Python/pandas):**

\`\`\`python
# v2.2 parser (40 columns)
df = pd.read_csv("scan_v2.2.csv")
atm_opps = df[df["structure"] == "atm-call"]
atm_opps = atm_opps[atm_opps["atm_ff"] >= 0.23]  # OLD

# v3.0 parser (32 columns)
df = pd.read_csv("scan_v3.0.csv")
atm_opps = df[df["structure"] == "atm-call"]
atm_opps = atm_opps[atm_opps["ff"] >= 0.23]  # NEW
\`\`\`

**Column Mapping Table:**

| v2.2 Column | v3.0 Column | Notes |
|-------------|-------------|-------|
| `atm_strike` | `strike` | Unified namespace |
| `atm_delta` | `delta` | Unified namespace |
| `atm_ff` | `ff` | Unified namespace |
| ... (full mapping table) ...
```

**3. Update CLI Flags Section:**
```markdown
### Command Line Flags

**Core Parameters:** ...

**Output Modes:**
- `--quiet`: Suppress per-symbol output, show only summary and errors
- `--verbose`: Show ALL symbols (pass, filter, skip, error)
- `--log-file <path>`: Write all logs to file with timestamps

**IV Source Control:**
- `--iv-ex-earn`: Use ex-earn IV instead of Greeks IV (20-30% faster)

**Examples:**
\`\`\`bash
# Quiet mode with CSV output
python scripts/ff_tastytrade_scanner.py --tickers SPY QQQ --pairs 30-60 --quiet --csv-out scan.csv

# Verbose mode with file logging
python scripts/ff_tastytrade_scanner.py --tickers AAPL TSLA --pairs 30-90 --verbose --log-file scan.log

# Ex-earn IV for faster scanning
python scripts/ff_tastytrade_scanner.py --tickers @SP500 --pairs 30-60 --iv-ex-earn
\`\`\`
```

**4. Update README_TT.md with Terminal Output Examples:**
```markdown
### Terminal Output Modes

**Normal Mode (default):**
\`\`\`
[SPY   ] PASS: FF=0.285 (30-60 DTE, strike=450.0, double)
[TSLA  ] PASS: FF=0.235 (60-90 DTE, strike=880.0, atm-call)
Scan complete: 150 scanned, 23 passed, 127 filtered (82s)
\`\`\`

**Quiet Mode (--quiet):**
\`\`\`
Scan complete: 150 scanned, 23 passed, 127 filtered (82s)
\`\`\`

**Verbose Mode (--verbose):**
\`\`\`
[SPY   ] PASS: FF=0.285 (call=0.29, put=0.28), 30-60 DTE, strike=450.0/445.0
[QQQ   ] FILTER: earnings_conflict (2025-11-15)
[AAPL  ] FILTER: volume_too_low (3.2k < 10k)
... (ALL symbols shown)
\`\`\`

### Performance Comparison (--iv-ex-earn)

**Greeks IV (default):**
\`\`\`
python scripts/ff_tastytrade_scanner.py --tickers SPY QQQ AAPL TSLA NVDA (50 symbols)
Runtime: 45s
\`\`\`

**Ex-earn IV (--iv-ex-earn):**
\`\`\`
python scripts/ff_tastytrade_scanner.py --tickers SPY QQQ AAPL TSLA NVDA (50 symbols) --iv-ex-earn
Runtime: 32s (28% faster)
\`\`\`
```

**5. Update Version History:**
```markdown
## Version History

### v3.0 - CSV Schema Refactor & Terminal Output Improvements (October 2025)

**Summary:** CSV schema refactor (40 → 32 columns), professional terminal output, IV source control

**Major Changes:**
- CSV Schema: Eliminated `atm_*` namespace, unified columns for both structures
- Terminal Output: Hierarchical logging with output modes (`--quiet`, `--verbose`)
- IV Source Control: Added `--iv-ex-earn` flag for 20-30% performance improvement
- Bug Fix: High-volume scanning crash fixed (Pydantic error handling)
- File Logging: Added `--log-file` flag for archiving scan results

**Breaking Changes:**
- CSV schema v3.0 incompatible with v2.2 parsers (migration guide provided)
- Column count reduced from 40 → 32
- Column renaming: `call_strike` → `strike`, `call_delta` → `delta`, `call_ff` → `ff`
```

### Key Considerations
- Maintain existing documentation structure
- Preserve v2.2 schema reference for migration
- Add concrete examples (not just descriptions)
- Include performance benchmarks where applicable

## Dependencies

**Internal:**
- [x] Task #36 (`--iv-ex-earn`) must be complete
- [x] Task #38 (Logging System) must be complete
- [x] Task #39 (Output Modes) must be complete
- [x] Task #40 (File Logging) must be complete
- [x] Task #41 (CSV Refactor) must be complete
- [x] Task #42 (Column Reordering) must be complete

## Effort Estimate

- **Size:** M (Medium)
- **Hours:** 4-6 hours
- **Parallel:** true (no conflicts, can run while testing)

### Breakdown:
- Update CLAUDE.md (schema, migration guide, flags): 2-3 hours
- Update README_TT.md (examples, performance): 2-3 hours

## Definition of Done

- [ ] CLAUDE.md shows v3.0 CSV schema (32 columns)
- [ ] Column mapping table created (v2.2 → v3.0)
- [ ] All new CLI flags documented with examples
- [ ] Terminal output modes documented with examples
- [ ] Performance comparison added (`--iv-ex-earn` vs default)
- [ ] Version history updated (v3.0 entry added)
- [ ] No broken links or references to old column names
